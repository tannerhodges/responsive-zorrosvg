<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>A Pen by Tanner Hodges</title>

  <!-- Styles -->
  <link rel="stylesheet" href="css/normalize.css">
  <link rel="stylesheet" href="css/style.css">
</head>
<body>

  <!-- ZorroSVG as background image w/ browser fixes -->
  <section class="o-zorro-svg  /  c-home-food">
    <object class="_fix-safari-svg-height  /  o-zorro-svg__image">
      <svg class="_fix-safari-svg-height__svg" width="1200" height="717" viewBox="0 0 1200 717" preserveAspectRatio="xMinYMin slice">

        <!-- Filter -->
        <defs>
          <filter id="svg-filter">
            <feOffset dy="-717" in="SourceGraphic" result="b"></feOffset>
            <feColorMatrix in="b" result="b" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0"></feColorMatrix>
            <feComposite in="SourceGraphic" in2="b" operator="in"></feComposite>
          </filter>
        </defs>

        <!-- Image -->
        <g filter="url(#svg-filter)">
          <foreignObject x="0" y="0" width="100%" height="200%">
            <!-- https://responsiveimages.org/ -->
            <img src="http://files.tannerhodges.com/codepen/img/responsive-zorrosvg/v3/progressive/home-food__bg.jpg"
                srcset="http://files.tannerhodges.com/codepen/img/responsive-zorrosvg/v3/progressive/home-food__bg-3x.jpg     1200w,
                        http://files.tannerhodges.com/codepen/img/responsive-zorrosvg/v3/progressive/home-food__bg-2.5x.jpg   1000w,
                        http://files.tannerhodges.com/codepen/img/responsive-zorrosvg/v3/progressive/home-food__bg-2x.jpg      800w,
                        http://files.tannerhodges.com/codepen/img/responsive-zorrosvg/v3/progressive/home-food__bg-1.5x.jpg    600w,
                        http://files.tannerhodges.com/codepen/img/responsive-zorrosvg/v3/progressive/home-food__bg.jpg         400w"
                sizes="100vw"
                alt="">
          </foreignObject>
        </g>

      </svg>
    </object>

    <!-- Content -->
    <div class="o-zorro-svg__content  /  u-gutter">
      <h1>Responsive ZorroSVG</h1>
      <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Quam voluptatibus fugiat, in delectus. Assumenda neque quasi odio dicta error. Consequatur a natus deserunt aliquid tenetur alias soluta. Commodi, repudiandae, corrupti.</p>
    </div>
  </section>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/3.2.0/imagesloaded.pkgd.min.js"></script>
  <script>
  var startTime = Date.now();
  function timeSince() {
    return Date.now() - startTime;
  }

  console.log('Start script', timeSince());
  var objects = document.querySelectorAll('.o-zorro-svg__image');

  function triggerLayout() {
    console.log('Trigger layout', timeSince());
    for (var i = 0; i < objects.length; i++) {
      console.log(objects[i], timeSince());
      objects[i].style.margin = 'auto';
    }
  }

  console.log('Adding listener', timeSince());
  imagesLoaded(objects, triggerLayout);
  </script>
</body>
</html>
